---
title: "Tarea_FCL"
author: "María Riera"
date: "11/12/2021"
output: html_document
---

AUTORES:
MORTARA Verónica Aída
NICOLAO GARCIA Jose Ingnacio
NIEZWIDA Sonia Romina
NOVILLO V. Sylvia M.
NUÑEZ Sonia
QUEMEL Renata
TABONE Luciana
RIERA María

## Caso de Estudio: Ubicación más adecuada de  puntos cross- docking para Quito, Ecuador.

Se abordará un caso de tipo exploratorio/cumulativos, con el propósito de determinar la ubicación más adecuada para la instalación de puntos de cross-dock para productos alimenticios en la ciudad de Quito. Describir la problemática /caso de estudio  en cuestión -  ( Silvia/Romina)
### Datos

Se trabajó con los resultados obtenidos en el trabajo de investigación realizado por Sarzosa (2020), en la cual se determinó las mejores ubicaciones de X-Docks para la distribución de alimentos en casos de emergencia por riesgo biológico en el Distrito Metropolitano de Quito, Ecuador.
ampliar datos tomads de la tesis, en base los cuales se  aplica la metodología (Silvia/Romina)

### Métodos utilizados:
Importancia de AHP y ORLOCA  para  facility location  (María)-  (facloc)
Método orloca: María
ahp: Luciana y Verónica

#### 1. Método ORLoca

**Coordenadas de los puntos de ubicación:**

- Parque 1: La Luz (-0.14608703953411817, -78.47976960272207)
- Parque 2: Ciudadela Ibarra (-0.2966791546368687, -78.56231390149335)
- Parque 3: España (-0.25933825401926136, -78.52948688799921)
- Parque 4: Arbolito (-0.2108757506647951, -78.49682275703417)

```{r}
library(orloca)

parques = loca.p(c(-0.14608703953411817, -0.2966791546368687, -0.25933825401926136, -0.2108757506647951), c(-78.47976960272207, -78.56231390149335, -78.52948688799921, -78.49682275703417))
plot(parques)
summary(parques)
```

**Distancia mín##
```{r}
dmin <- distsummin(parques)
dmin
```


Evaluamos la función y el gradiente en el punto obtenido:

```{r}
distsum(o = parques, x = dmin[1], y = dmin[2])
distsumgra(o = parques, x = dmin[1], y = dmin[2])
```

#### 2. Proceso de Jerarquía Analítica (AHP)

**Alternativas de selección**
- Parque 1: La Luz
- Parque 2: Ciudadela Ibarra
- Parque 3: España
- Parque 4: Arbolito

**Criterios:**
Criterios:
c1 :densidad poblacional - preferible alta
c2: Facilidad de instalacion  - preferible alto
c3: volumen de demanda (toneladas de alimento)
c4: ubicación geográfica (cercania a vias de acceso principales)


Matriz de criterios
## a colocar valos de 1 a 9  - escala de Saaty
	C1	C2	C3	C4
C1	1	1/2	1/5	3	
C2	2	1	1/3	5	
C3	5	3	1	7	
C4	1/3	1/5	1/7	1	

Matriz de alternativas C1
## a colocar valos de 1 a 9  - escala de Saaty
	A1	A2	A3	A4
A1	1	5	7	1/2
A2	1/5	1	2	1/7
A3	1/7	1/2	1	1/9	
A4	2	7 	9	1

Matriz de alternativas C2
## a colocar valos de 1 a 9  - escala de Saaty
	A1	A2	A3	A4
A1	1	2	4	1/5
A2	1/2	1	1/2	1/9
A3	1/4	2	1	1/7	
A4	5	9 	7	1

Matriz de alternativas C3
## a colocar valos de 1 a 9  - escala de Saaty
	A1	A2	A3	A4
A1	1	7	9	2
A2	1/7	1	2	1/5
A3	1/9	1/2	1	1/7	
A4	1/2	5 	7	1

Matriz de alternativas C4
## a colocar valos de 1 a 9  - escala de Saaty
	A1	A2	A3	A4
A1	1	4	2	1/5
A2	1/4	1	2	1/7
A3	1/2	1/2	1	1/9	
A4	5	 7 	9	1


**Medición de la consistencia de la matriz de alternativas**


```{r}
comparisonMatrixValues = c(1,1/2,1/5,3,2,1,1/3,5,5,3,1,7,1/3,1/5,1/7,1)
comparisonMatrix = matrix(comparisonMatrixValues, nrow = 4, ncol = 4, byrow = TRUE)
library(FuzzyAHP)
comparisonMatrix = pairwiseComparisonMatrix(comparisonMatrix)
show(comparisonMatrix)
```
**Pesos de criterios**

```{r}
weights = calculateWeights(comparisonMatrix)
print(weights)
```


**Comparación de Alternativas. Criterio: Densidad Poblacional**

```{r}
values0 = c(1, 5, 7, 1/2, 1/5, 1, 2, 1/7, 1/7, 1/2, 1, 1/9, 2, 7, 9, 1)
values0 = matrix(values0, nrow = length(values0)/length(weights@weights), ncol = length(weights@weights), byrow = TRUE)
values0 = pairwiseComparisonMatrix(values0)
consistencyRatio(values0)
values0
weightsv0 = calculateWeights(values0)
print(weightsv0)
```

**Comparación de Alternativas. Criterio: Facilidad de instalación**

```{r}
values1 = c(1, 2, 4, 1/5, 1/2, 1, 1/2, 1/9, 1/4, 2, 1, 1/7, 5, 9, 7, 1)
values1 = matrix(values1, nrow = length(values1)/length(weights@weights), ncol = length(weights@weights), byrow = TRUE)
values1 = pairwiseComparisonMatrix(values1)
consistencyRatio(values1)
values1
weightsv1 = calculateWeights(values1)
print(weightsv1)
```

**Comparación de Alternativas. Criterio: Volumen de demanda**

```{r}
values2 = c(1, 7, 9, 2, 1/7, 1, 2, 1/5, 1/9, 1/2, 1, 1/7, 1/2, 5, 7, 1)
values2 = matrix(values2, nrow = length(values2)/length(weights@weights), ncol = length(weights@weights), byrow = TRUE)
values2 = pairwiseComparisonMatrix(values2)
consistencyRatio(values2)
values2
weightsv2 = calculateWeights(values2)
print(weightsv2)
```

**Comparación de Alternativas. Criterio: Ubicación geográfica**

```{r}
values3 = c(1, 4, 2, 1/5, 1/4, 1, 2, 1/7, 1/2, 1/2, 1, 1/9, 5, 7, 9, 1)
values3 = matrix(values3, nrow = length(values3)/length(weights@weights), ncol = length(weights@weights), byrow = TRUE)
values3 = pairwiseComparisonMatrix(values3)
consistencyRatio(values3)
values3
weightsv3 = calculateWeights(values3)
print(weightsv3)
```

**Construccion matriz values**

```{r}
values = c(0.3308, 0.0791, 0.0483, 0.5419,0.1796, 0.0652, 0.0825, 0.6727,0.5419, 0.0791, 0.0483, 0.3308,0.1796, 0.0825, 0.0652, 0.6727)
tvalues=t(values)
tvalues= matrix(tvalues,nrow = length(tvalues)/length(weights@weights), ncol = length(weights@weights))
tvalues
```


**Jerarquizacion final**

```{r}
result = calculateAHP(weights, tvalues)
print(result)
```
```{r}
rank = compareResults(result)
print(rank)
```

```{r}
result = cbind(tvalues, result, rank)
colnames(result) = c("Densidad Pobl.", "Facilidad de Inst.", "Demanda", "Ubicación","Resultado","Ranking")

print(result)
```



![image](https://user-images.githubusercontent.com/95756862/145688943-10c5d820-5607-470f-846c-1792d1ce3f37.png)

## CONSISTENCIA DE MATRIZ: ver https://www.math.ucla.edu/~anderson/rw1001/library/base/html/kappa.html
https://cran.r-project.org/web/packages/FuzzyAHP/vignettes/examples.html

```{r setup, include=FALSE}
library(readr)
empresas <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSoscPk0Y_eMo7hVRk-oAgw1x6QfRWR9P8nPTEppCYHAE9zwsSup4O5Z9UHtOYUVKzLO9scFZf4neLg/pub?output=csv")
```

```{r}
hist(empresas$`Grado de innovación`)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
##Resultados y comparación de méstodos ( distinguir las mejores ubicaciones) -
## conclusiones 


